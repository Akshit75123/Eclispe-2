/*for fetching the data from jdbc*/

package com.telusko.web.dao;

import java.sql.*;


import com.telusko.web.model.Alien;

public class AlienDao {
	
	public Alien getAlien(int aid) {
		/*
		 * Alien a = new Alien(); a.setAid(101); a.setAname("Navin"); a.setTech("java");
		 */ 
		Alien a = new Alien();
		boolean alienPresent = true;
		try {
			Class.forName("com.mysql.jdbc.Driver");
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/new","root","akshit");
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("select * from aliein where aid ="+aid);
			if (rs.next()) {
				a.setAid(rs.getInt("aid"));
				a.setAname(rs.getString("aname"));
				a.setTech(rs.getString("tech"));
			}
			else {
				alienPresent = false;
			}
		}
		catch(Exception e) {
			System.out.println(e);
		}
		
		return a;
	}
	
	public boolean isPresent(int aid) {
		Alien a = new Alien();
		try {
			Class.forName("com.mysql.jdbc.Driver");
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/new","root","akshit");
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("select * from aliein where aid ="+aid);
			if (rs.next()) {
				return true;
			}
		}
		catch(Exception e) {
			System.out.println(e);
		}
		return false;
		
	}
	public boolean setValues(int aid, String aname, String tech) {
        try {
            // Load the MySQL driver
            Class.forName("com.mysql.cj.jdbc.Driver");

            // Establish the connection to the database
            Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/new", "root", "akshit");

            // Use a PreparedStatement to avoid SQL injection and handle values properly
            String query = "INSERT INTO alien (aid, aname, tech) VALUES (?, ?, ?)";
            PreparedStatement pst = con.prepareStatement(query);

            // Set the values for each placeholder
            pst.setInt(1, aid);
            pst.setString(2, aname);
            pst.setString(3, tech);

            // Execute the query and check if rows are affected
            int rowsAffected = pst.executeUpdate();
            if (rowsAffected > 0) {
                return true;  // Successfully inserted the data
            }
        } catch (Exception e) {
            System.out.println(e);
        }
        return false;  // If an error occurs or no rows are affected
    }
}
	
}
